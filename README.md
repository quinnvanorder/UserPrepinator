<br>This project has been paused for now, as the project to develop it was cancelled. Since then, I have looked into utilizing the API, as it would allow procedures to schedule other procedures while passing variables to them. By doing this, it both negates the need to dump data to text files to pass back and forth, but also negates the need to add encryption, as Kaseya communicates through an encrypted tunnel. Should I be given the opportunity later, I am confiednt this could be made into a much more refined product<br/>

<br>Step 1) Kaseya procedure acquires all needed variables. This is done with a combination of pulling from per container managed variables, and from prompting the tech. This procedure dumps all variables into a txt file, and fires off PrereqCheck.ps1. Said PS1 will write out each check to a txt file, which is then assessed by Kaseya. If the error logging file contains any failures, the initial Kaseya procedure sends a failure email to the tech in question, attaching the failure logs, and terminates all subsequent procedures. Otherwise if the checks pass, Kaseya will then copy the variables txt file onto the target DC of the client in question. It will then schedule the second phase on said DC. Note: Phase 1 is always fired against a specific target server that is configured with all Office 365 Powershell components. Due to the variety and frequently changing nature of the needed components, this option is a lot simpler than forcing a wide array of DC’s to hold all of these components. <br/>

<br>Step 2) Second Kaseya procedure, previously scheduled against target DC drops ADConfiguration.ps1 onto the server in question and executes it. The PS1 is designed to pull all needed variables for the user setup from the variables file passed to the DC in step 1. It then sends a “try” procedure to the server holding the DirSync client, attempting to force replication. Phase 3 is designed to assume the DirSync procedure fails, and will loop forever until the user is synced to the cloud before beginning work. Finally, this procedure schedules Phase 3. This final step is passed back to the initial server, as it contains the various components needed to dial into Office 365 Powershell. <br/>

<br>Step 3) The final script, 365Configuration.ps1 is passed to the server and executed. Step 3 has essentially no logic in Kaseya, as the PS1 does all the work. It loops waiting for the user to show up in the cloud, assigns a license, and then loops again, this time waiting for the mailbox to be provisioned. Finally it completes any needed post provisioning steps, such as setting calendar permissions. <br/> 

